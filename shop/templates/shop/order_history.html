{% extends 'shop/base.html' %}
{% load static %}

{% block title %}تاریخچه سفارشات | کافی شاپ{% endblock %}

{% block extra_head %}
<style>
.order-history-container {
    max-width: 1000px;
    margin: 2rem auto;
    padding: 0 1rem;
}

.history-header {
    background: linear-gradient(135deg, #F3E9DC 0%, #FFF8F0 100%);
    border-radius: 1.5rem;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 24px rgba(75,46,43,0.1);
    border: 2px solid #4B2E2B22;
    text-align: center;
}

.history-title {
    color: #4B2E2B;
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 1rem;
}

.history-subtitle {
    color: #7B3F00;
    font-size: 1.1rem;
}

.orders-grid {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.order-card {
    background: #FFF8F0;
    border-radius: 1.5rem;
    padding: 2rem;
    box-shadow: 0 4px 16px rgba(75,46,43,0.1);
    border: 2px solid #4B2E2B22;
    transition: all 0.3s;
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    display: block;
}

.order-card:hover {
    border-color: #C97C5D;
    transform: translateY(-3px);
    box-shadow: 0 8px 32px rgba(75,46,43,0.15);
    background: #FFF8F0;
}

.order-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.order-id {
    font-weight: bold;
    color: #4B2E2B;
    font-size: 1.3rem;
}

.order-status {
    padding: 0.6rem 1.2rem;
    border-radius: 2rem;
    font-size: 1rem;
    font-weight: bold;
}

.status-pending { background: #FFF3CD; color: #856404; }
.status-paid { background: #D1ECF1; color: #0C5460; }
.status-processing { background: #D4EDDA; color: #155724; }
.status-shipped { background: #CCE5FF; color: #004085; }
.status-delivered { background: #D1E7DD; color: #0F5132; }
.status-cancelled { background: #F8D7DA; color: #721C24; }

.order-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
}

.detail-item {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
}

.detail-label {
    color: #7B3F00;
    font-size: 0.9rem;
    font-weight: bold;
}

.detail-value {
    color: #4B2E2B;
    font-size: 1rem;
}

.order-total {
    background: linear-gradient(135deg, #4B2E2B 0%, #7B3F00 100%);
    color: #FFF8F0;
    border-radius: 1rem;
    padding: 1rem 1.5rem;
    text-align: center;
    margin-bottom: 1rem;
}

.total-amount {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 0.3rem;
}

.total-label {
    font-size: 0.9rem;
    opacity: 0.9;
}

.order-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 1rem;
}

.view-details {
    background: #4B2E2B;
    color: #FFF8F0;
    border: none;
    padding: 0.8rem 1.5rem;
    border-radius: 2rem;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    text-decoration: none;
    display: inline-block;
}

.view-details:hover {
    background: #C97C5D;
    transform: translateY(-2px);
}

.order-date {
    color: #C97C5D;
    font-size: 0.95rem;
}

.empty-orders {
    text-align: center;
    padding: 3rem;
    color: #C97C5D;
    font-size: 1.2rem;
    background: #FFF8F0;
    border-radius: 1.5rem;
    box-shadow: 0 4px 16px rgba(75,46,43,0.1);
}

.back-btn {
    background: #4B2E2B;
    color: #FFF8F0;
    border: none;
    padding: 1rem 2rem;
    border-radius: 2rem;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    text-decoration: none;
    display: inline-block;
    margin-top: 2rem;
}

.back-btn:hover {
    background: #C97C5D;
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .order-card-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .order-details {
        grid-template-columns: 1fr;
    }
    
    .order-actions {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="order-history-container">
    <div class="history-header">
        <h1 class="history-title">تاریخچه سفارشات</h1>
        <p class="history-subtitle">تمام سفارشات شما در یک مکان</p>
    </div>

    <div class="orders-grid">
        {% for order in orders %}
            <a href="{% url 'order_detail' order.id %}" class="order-card">
                <div class="order-card-header">
                    <span class="order-id">سفارش #{{ order.id }}</span>
                    <span class="order-status status-{{ order.status }}">{{ order.get_status_display }}</span>
                </div>
                
                <div class="order-details">
                    <div class="detail-item">
                        <span class="detail-label">تاریخ سفارش</span>
                        <span class="detail-value">{{ order.created_at|date:"Y/m/d H:i" }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">آخرین بروزرسانی</span>
                        <span class="detail-value">{{ order.updated_at|date:"Y/m/d H:i" }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">تعداد محصولات</span>
                        <span class="detail-value">{{ order.items.count }} محصول</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">آدرس ارسال</span>
                        <span class="detail-value">{{ order.shipping_address|truncatechars:30 }}</span>
                    </div>
                </div>
                
                <div class="order-total">
                    <div class="total-amount">{{ order.total_amount|floatformat:0 }} تومان</div>
                    <div class="total-label">مبلغ کل سفارش</div>
                </div>
                
                <div class="order-actions">
                    <span class="order-date">{{ order.created_at|date:"Y/m/d" }}</span>
                    <span class="view-details">مشاهده جزئیات</span>
                </div>
            </a>
        {% empty %}
            <div class="empty-orders">
                <p>هنوز سفارشی ثبت نکرده‌اید.</p>
                <p style="margin-top: 1rem; font-size: 1rem;">برای مشاهده سفارشات، ابتدا محصولی خریداری کنید.</p>
            </div>
        {% endfor %}
    </div>

    <div style="text-align: center;">
        <a href="{% url 'user_profile' %}" class="back-btn">بازگشت به پروفایل</a>
    </div>
</div>
{% endblock %} 